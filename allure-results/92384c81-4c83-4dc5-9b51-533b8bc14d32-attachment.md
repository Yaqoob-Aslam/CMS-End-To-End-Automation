# Test info

- Name: CMS End-to-End Automation >> Create Subgroup
- Location: /home/yaqoob/CMS-End-To-End-Automation/tests/CMS_Automation_1.0.spec.js:356:7

# Error details

```
TimeoutError: locator.click: Timeout 10000ms exceeded.
Call log:
  - waiting for getByRole('link', { name: 'Subgroups' })

    at /home/yaqoob/CMS-End-To-End-Automation/tests/CMS_Automation_1.0.spec.js:357:57
```

# Test source

```ts
  257 | // const uniqueEmail = `${uniqueFirstName.toLowerCase()}.${uniqueLastName.toLowerCase()}${groupNumber}@mailinator.com`; // public temp email
  258 |
  259 | // // ✅ Create Manager with unique details
  260 | // await page.getByRole('link', { name: 'User Account' }).click();
  261 | // await page.getByRole('button', { name: '+ Create Manager' }).click();
  262 |
  263 | // await page.getByRole('textbox', { name: 'Enter first name' }).click();
  264 | // await page.getByRole('textbox', { name: 'Enter first name' }).fill(uniqueFirstName);
  265 |
  266 | // // Ensure last name field is focused before filling
  267 | // await page.getByRole('textbox', { name: 'Enter last name' }).click();
  268 | // await page.getByRole('textbox', { name: 'Enter last name' }).fill(uniqueLastName);
  269 |
  270 | // // Ensure email field is focused before filling
  271 | // await page.getByRole('textbox', { name: 'Enter email' }).click();
  272 | // await page.getByRole('textbox', { name: 'Enter email' }).fill(uniqueEmail);
  273 |
  274 | // // ✅ Select newly created group
  275 | // await page.locator('.css-19bb58m').click();
  276 | // await page.getByRole('option', { name: groupName }).click();
  277 |
  278 | // // Wait for "Add" button to be enabled and visible before clicking
  279 | // const managerAddButton = page.getByRole('button', { name: 'Add' });
  280 | // await managerAddButton.waitFor({ state: 'visible', timeout: 10000 });
  281 | // await expect(managerAddButton).toBeEnabled({ timeout: 10000 });
  282 | // await managerAddButton.click();
  283 | // await page.getByRole('button', { name: 'Done' }).click();
  284 | // console.log(`✅ Manager Created: ${uniqueFirstName} ${uniqueLastName}, Email: ${uniqueEmail}, Group: ${groupName}`);
  285 |
  286 | // // ✅ Logout
  287 | // await page.getByRole('button', { name: 'A', exact: true }).click();
  288 | // await page.getByRole('button', { name: 'Logout' }).click();
  289 | // await page.getByRole('button', { name: 'Yes' }).click();
  290 | // await page.waitForURL('**/login', { timeout: 60000 });
  291 | // console.log('✅ Logout successful');
  292 |
  293 | // await browser.close();
  294 | // });
  295 |
  296 | //--------------------------------------------------------------------------------------------------------------------------------------
  297 |
  298 |
  299 |
  300 | import { test, expect, chromium } from '@playwright/test';
  301 | import fs from 'fs';
  302 | import path from 'path';
  303 | import dotenv from 'dotenv';
  304 | dotenv.config();
  305 |
  306 | test.describe('CMS End-to-End Automation', () => {
  307 |   let browser, context, page;
  308 |   let groupNumber, groupName, subGroupName, subSubGroupName, playerName, videoFileName, scenarioName, timetableName, scheduleName;
  309 |   let videoDir, videoPath;
  310 |
  311 |   test.beforeAll(async () => {
  312 |     // Generate unique values
  313 |     groupNumber = Math.floor(Math.random() * 100000);
  314 |     groupName = `Group U${groupNumber}`;
  315 |     subGroupName = `Subgroup U${groupNumber}`;
  316 |     subSubGroupName = `Sub Subgroup U${groupNumber}`;
  317 |     playerName = `Player U${groupNumber}`;
  318 |     videoFileName = `test__${groupNumber}.mp4`;
  319 |     scenarioName = `Scenario U${groupNumber}`;
  320 |     timetableName = `Timetable U${groupNumber}`;
  321 |     scheduleName = `Schedule U${groupNumber}`;
  322 |
  323 |     // Video path setup
  324 |     const projectRoot = path.resolve(__dirname, '..');
  325 |     videoDir = path.join(projectRoot, 'videos');
  326 |     const existingFiles = fs.existsSync(videoDir) ? fs.readdirSync(videoDir) : [];
  327 |     const firstVideo = existingFiles.find(file => file.endsWith('.mp4'));
  328 |     if (!firstVideo) throw new Error('⚠️ No video found in videos/ folder');
  329 |     fs.renameSync(path.join(videoDir, firstVideo), path.join(videoDir, videoFileName));
  330 |     videoPath = path.join(videoDir, videoFileName);
  331 |
  332 |     // Browser setup
  333 |     browser = await chromium.launch({ headless: false, args: ['--start-maximized'] });
  334 |     context = await browser.newContext({ viewport: null, deviceScaleFactor: undefined });
  335 |     page = await context.newPage();
  336 |   });
  337 |
  338 |   test('Login to CMS', async () => {
  339 |     await page.goto('https://moyai-cms.innov8.jp/login', { timeout: 90000 });
  340 |     if (!process.env.CMS_EMAIL || !process.env.CMS_PASSWORD) throw new Error('Missing CMS_EMAIL or CMS_PASSWORD');
  341 |     await page.getByRole('textbox', { name: 'Enter your email address' }).fill(process.env.CMS_EMAIL);
  342 |     await page.getByRole('textbox', { name: 'Enter your password' }).fill(process.env.CMS_PASSWORD);
  343 |     await page.getByRole('button', { name: 'Login' }).click();
  344 |     await page.waitForURL('**/dashboard', { timeout: 60000 });
  345 |   });
  346 |
  347 |   test('Create Group', async () => {
  348 |     await page.getByRole('button', { name: 'Expand Icon' }).click();
  349 |     await page.getByRole('link', { name: 'Groups' }).click();
  350 |     await page.getByRole('button', { name: '+ Add Group' }).click();
  351 |     await page.getByRole('textbox', { name: 'Enter group name' }).fill(groupName);
  352 |     await page.getByRole('button', { name: 'Add' }).click();
  353 |     await page.getByRole('button', { name: 'Done' }).click();
  354 |   });
  355 |
  356 |   test('Create Subgroup', async () => {
> 357 |     await page.getByRole('link', { name: 'Subgroups' }).click();
      |                                                         ^ TimeoutError: locator.click: Timeout 10000ms exceeded.
  358 |     await page.getByRole('button', { name: '+ Add Subgroup' }).click();
  359 |     await page.locator('.css-19bb58m').first().click();
  360 |     await page.getByRole('option', { name: groupName }).click();
  361 |     await page.getByRole('textbox', { name: 'Enter sub group name' }).fill(subGroupName);
  362 |     await page.getByRole('button', { name: 'Add' }).click();
  363 |     await page.getByRole('button', { name: 'Done' }).click();
  364 |   });
  365 |
  366 |   test('Create Sub-Subgroup', async () => {
  367 |     await page.getByRole('link', { name: 'Sub Subgroups' }).click();
  368 |     await page.getByRole('button', { name: '+ Add Sub Subgroup' }).click();
  369 |     await page.locator('.css-19bb58m').first().click();
  370 |     await page.getByRole('option', { name: groupName }).click();
  371 |     await page.locator('.css-35k6c7-control .css-19bb58m').click();
  372 |     await page.getByRole('option', { name: subGroupName }).click();
  373 |     await page.getByRole('textbox', { name: 'Enter sub subgroup name' }).fill(subSubGroupName);
  374 |     await page.getByRole('button', { name: 'Add' }).click();
  375 |     await page.getByRole('button', { name: 'Done' }).click();
  376 |   });
  377 |
  378 |   test('Create Player', async () => {
  379 |     await page.getByRole('link', { name: 'Lan Manager' }).click();
  380 |     await page.getByRole('button', { name: '+ Add Player' }).click();
  381 |     await page.locator('.css-19bb58m').first().click();
  382 |     await page.getByRole('option', { name: groupName }).click();
  383 |     await page.locator('.css-35k6c7-control > .css-hlgwow > .css-19bb58m').click();
  384 |     await page.getByRole('option', { name: subGroupName }).click();
  385 |     await page.locator('div:nth-child(3) > .css-b62m3t-container > .css-35k6c7-control > .css-hlgwow > .css-19bb58m').click();
  386 |     await page.getByRole('option', { name: subSubGroupName }).click();
  387 |     await page.getByRole('textbox', { name: 'Enter player name' }).fill(playerName);
  388 |     await page.getByRole('button', { name: 'Add' }).click();
  389 |     await page.waitForSelector('text=Player added successfully.', { timeout: 15000 });
  390 |     await page.getByRole('button', { name: 'Done' }).click();
  391 |   });
  392 |
  393 |   test('Upload Video', async () => {
  394 |     const stats = fs.statSync(videoPath);
  395 |     if (stats.size > 50 * 1024 * 1024) throw new Error('Video exceeds 50MB');
  396 |     await page.getByRole('link', { name: 'Contents' }).click();
  397 |     await page.getByRole('link', { name: 'Scenario' }).click();
  398 |     await page.getByRole('button', { name: 'All Videos' }).click();
  399 |     await page.getByRole('button', { name: '+ Add Videos' }).click();
  400 |     await page.locator('input[type="file"]').setInputFiles(videoPath);
  401 |     await page.waitForSelector(`text=${videoFileName}`, { timeout: 180000 });
  402 |     await page.waitForSelector('text=Loading...', { state: 'detached', timeout: 480000 });
  403 |     await page.getByRole('button', { name: 'Add' }).click();
  404 |     await page.getByRole('button', { name: 'Done' }).click();
  405 |   });
  406 |
  407 |   // You would continue similarly for:
  408 |   // - Create Scenario
  409 |   // - Create Timetable
  410 |   // - Create Schedule
  411 |   // - Assign Scenario to Player
  412 |   // - Create Manager
  413 |   // - Logout
  414 |
  415 |   test.afterAll(async () => {
  416 |     await browser.close();
  417 |   });
  418 | });
  419 |
```